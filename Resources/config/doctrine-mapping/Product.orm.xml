<?xml version="1.0" encoding="UTF-8"?>
<doctrine-mapping xmlns="http://doctrine-project.org/schemas/orm/doctrine-mapping"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://doctrine-project.org/schemas/orm/doctrine-mapping
	http://doctrine-project.org/schemas/orm/doctrine-mapping.xsd">
	
	<entity name="ASF\ProductBundle\Entity\Product" inheritance-type="JOINED" table="asf_product_product">

		<discriminator-column name="discr" type="string" />
		<discriminator-map>
			<discriminator-mapping value="Product" class="Product" />
			<discriminator-mapping value="ProductPack" class="ProductPack" />
		</discriminator-map>
		
		<many-to-many field="categories" target-entity="Category">
			<join-table name="asf_product_product_category">
				<join-columns>
					<join-column name="product_id" referenced-column-name="id" />
				</join-columns>
				<inverse-join-columns>
					<join-column name="category_id" referenced-column-name="id" />
				</inverse-join-columns>
			</join-table>
		</many-to-many>
		
		<many-to-one field="brand" target-entity="Brand" inversed-by="products">
			<join-column name="brand_id" referenced-column-name="id" nullable="true" />
			<cascade>
				<cascade-persist />
			</cascade>
		</many-to-one>
		
	</entity>
	
</doctrine-mapping>